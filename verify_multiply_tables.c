#include <stdio.h>

void generate_multiply_tables(unsigned char *table_plus,
                              unsigned char *table_minus);

// Tables generated by mul_tables.py
unsigned char ref_table_plus[] = {0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,4,4,5,5,6,6,7,8,9,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,25,26,27,28,30,31,33,34,36,37,39,40,42,43,45,47,49,50,52,54,56,58,60,62,64,66,68,70,72,74,76,78,81,83,85,87,90,92,95,97,100,102,105,107,110,112,115,118,121,123,126,129,132,135,138,141,144,147,150,153,156,159,162,165,169,172,175,178,182,185,189,192,196,199,203,206,210,213,217,221,225,228,232,236,240,244,248,252,0,4,8,12,16,20,24,28,33,37,41,45,50,54,59,63,68,72,77,81,86,90,95,100,105,109,114,119,124,129,134,139,144,149,154,159,164,169,174,179,185,190,195,200,206,211,217,222,228,233,239,244,250,255,5,11,17,22,28,34,40,46,52,58,64,70,76,82,88,94,100,106,113,119,125,131,138,144,151,157,164,170,177,183,190,196,203,210,217,223,230,237,244,251,2,9,16,23,30,37,44,51,58,65,73,80,87,94,102,109,117,124,132,139,147,154,162,169,177,185,193,200,208,216,224,232,240,248,0,8,16,24,32,40,48,56,65,73,81,89,98,106,115,123,132,140,149,157,166,174,183,192,201,209,218,227,236,245,254,7,16,25,34,43,52,61,70,79,89,98,107,116,126,135,145,154,164,173,183,192,202,211,221,231,241,250,4,14,24,34,44,54,64,74,84,94,104,114,124,134,145,155,165,175,186,196,207,217,228,238,249,3,14,24,35,46,57,67,78,89,100,111,122,133,144,155,166,177,188,199,210,221,233,244,255,10,22,33,45,56,68,79,91,102,114,125,137,149,161,172,184,196,208,220,232,244,0,12,24,36,48,60,72,84,97,109,121,133,146,158,171,183,196,208,221,233,246,2,15,28,41,53,66,79,92,105,118,131,144,157,170,183,196,209,222,235,249,6,19,32,46,59,73,86,100,113,127,140,154,167,181,195,209,222,236,250,8,22,36,50,64,78,92,106,120,134,148,162,177,191,205,219,234,248,7,21,36,50,65,79,94,108,123,138,153,167,182,197,212,227,242,1,16,31,46,61,76,91,106,121,137,152,167,182,198,213,229,244,4,19,35,50,66,81,97,113,129,144,160,176,192,208,224,240};

unsigned char ref_table_minus[] = {0,248,240,232,224,216,208,200,193,185,177,169,162,154,147,139,132,124,117,109,102,94,87,80,73,65,58,51,44,37,30,23,16,9,2,251,244,237,230,223,217,210,203,196,190,183,177,170,164,157,151,144,138,131,125,119,113,106,100,94,88,82,76,70,64,58,52,46,40,34,28,22,17,11,5,255,250,244,239,233,228,222,217,211,206,200,195,190,185,179,174,169,164,159,154,149,144,139,134,129,124,119,114,109,105,100,95,90,86,81,77,72,68,63,59,54,50,45,41,37,33,28,24,20,16,12,8,4,0,252,248,244,240,236,232,228,225,221,217,213,210,206,203,199,196,192,189,185,182,178,175,172,169,165,162,159,156,153,150,147,144,141,138,135,132,129,126,123,121,118,115,112,110,107,105,102,100,97,95,92,90,87,85,83,81,78,76,74,72,70,68,66,64,62,60,58,56,54,52,50,49,47,45,43,42,40,39,37,36,34,33,31,30,28,27,26,25,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,9,8,7,6,6,5,5,4,4,3,3,2,2,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,4,4,5,5,6,6,7,8,9,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,25,26,27,28,30,31,33,34,36,37,39,40,42,43,45,47,49,50,52,54,56,58,60,62,64,66,68,70,72,74,76,78,81,83,85,87,90,92,95,97,100,102,105,107,110,112,115,118,121,123,126,129,132,135,138,141,144,147,150,153,156,159,162,165,169,172,175,178,182,185,189,192,196,199,203,206,210,213,217,221,225,228,232,236,240,244,248,252,0,4,8,12,16,20,24,28,33,37,41,45,50,54,59,63,68,72,77,81,86,90,95,100,105,109,114,119,124,129,134,139,144,149,154,159,164,169,174,179,185,190,195,200,206,211,217,222,228,233,239,244,250,255,5,11,17,22,28,34,40,46,52,58,64,70,76,82,88,94,100,106,113,119,125,131,138,144,151,157,164,170,177,183,190,196,203,210,217,223,230,237,244,251,2,9,16,23,30,37,44,51,58,65,73,80,87,94,102,109,117,124,132,139,147,154,162,169,177,185,193,200,208,216,224,232,240,248};

unsigned char multiply_table_plus[512];
unsigned char multiply_table_minus[512];

void main() {
  unsigned short i;
  unsigned short err_cnt=0;

  generate_multiply_tables(multiply_table_plus, multiply_table_minus);

  // Comparing multiply tables against reference tables
  for (i=0; i < sizeof(ref_table_plus); i++) {
    // ref_table_plus and ref_table_minus have the same size

    if (ref_table_plus[i] != multiply_table_plus[i]) {
      printf("ref:%d gen:%d\n", ref_table_plus[i], multiply_table_plus[i]);
      err_cnt++;
    }

    if (ref_table_minus[i] != multiply_table_minus[i]) {
      printf("ref:%d gen:%d\n", ref_table_minus[i], multiply_table_minus[i]);
      err_cnt++;
    }
  }
  printf("Errors count: %u\n", err_cnt);
}
